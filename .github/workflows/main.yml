name: Build Fox RP Final Stable
on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: 'gradle'

      - name: Fox RP Branding
        run: |
          # Меняем название проекта в ресурсах
          find app/src/main/res -name "strings.xml" -exec sed -i 's/OpenSAMP/Fox RP/g' {} +
          
          # Устанавливаем оранжевый цвет Primary
          # Мы меняем цвет только если файл существует, чтобы не ломать билд
          COLOR_FILE="app/src/main/res/values/colors.xml"
          if [ -f "$COLOR_FILE" ]; then
            sed -i 's/<color name="colorPrimary">.*<\/color>/<color name="colorPrimary">#FF8C00<\/color>/g' $COLOR_FILE
          fi

      - name: Build APK with Gradle
        run: |
          chmod +x gradlew
          ./gradlew assembleDebug --no-daemon

      - name: Upload Final APK
        uses: actions/upload-artifact@v4
        with:
          name: Fox-RP-Stable
          path: app/build/outputs/apk/debug/*.apk
          
